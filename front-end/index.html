<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.0/Chart.bundle.min.js"></script>
    <script src="./data.js"></script>
    <!-- <script src="stuff.js"></script> -->
    <title>The Drought: Cape Town's Water Crisis</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.0/css/bulma.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>
    <section class="section">
        <div class="container">
            <h1 class="title">Cape Town's Water Crisis</h1>
            <h2 class="subtitle">Historical Dam Levels for the Cape Town Region: 2012&mdash;Present</h2>
            <canvas id="myChart" width="800" height="600"></canvas>
        </div>
    </section>
    <footer class="footer">
      <div class="container">
        <div class="content has-text-centered">
          <p>
            Made by <a href="http://www.coryzue.com">Cory Zue</a> and <a href="https://github.com/nathanbegbie">Nathan Begbie</a>.
          </p>
          <p>
            No <span class="icon has-text-info"><i class="fa fa-tint"></i></span> was wasted in the creation of this site.
            <a href="https://github.com/czue/capetown-drought">Source</a> on <i class="fa fa-github"></i>
          </p>
        </div>
      </div>
    </footer>
    <script>
    var ctx = document.getElementById("myChart");

    // dynamic legend for different browser widths
    function getLegend(width) {
        if (width < 600)
        {
            return {
                display: false
            };
        } else if (width < 1000) {
            return {
                display: true,
                position: "bottom"
            }
        } else {
            return {
                display: true,
                position: "right"
            }
        }
    }
    var myChart = new Chart(ctx, {
        type: 'line',
        data: data,
        options: {
            scales: {
                yAxes: [{
                    stacked: true,
                    ticks: {
                        callback: function(value, index, values) {
                            return value + " Ml";
                        }
                    }
                }],
            },
            elements: {
                point: {
                    radius: 0
                }
            },
            layout: {
                padding: 20,
            },
            legend: getLegend(document.body.clientWidth),
            maintainAspectRatio: true
        }
    });

    // hide legend on small devices
    // https://github.com/chartjs/Chart.js/issues/1933#issuecomment-174544514
    // this is wonky so don't bother for now.
    //    var resizeId;
    //    window.onresize = function(event) {
    //        clearTimeout(resizeId);
    //        resizeId = setTimeout(afterResizing, 100);
    //    };
    //    function afterResizing(){
    //        myChart.options.legend = getLegend(document.getElementById("myChart").clientWidth);
    //        myChart.update();
    //    }
    </script>
</body>
</html>
